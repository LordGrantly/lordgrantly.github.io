<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Our Version</title>

<style>
  #square{
    width: 250px;
    height: 250px;
    background-color: rgba(0,0,100,0.6);
    border: 5px solid black;
    position: absolute;
    left: 50px;
    top: 50px;
  }
  .enemy {
    width: 40px;
    height: 40px;
    background-color: red;
    border: 5px solid black;
    position: absolute;
  }
</style>
</head>

<body>
<div id="square"></div>
  
<canvas id="mycanvas"></canvas>

<script>
let selectedEnemy = null; 

let canvas, ctx;
const crosses = [];
const enemies = [];
const lifetime = 5000;
square.addEventListener("click", (event) => {
    if (!selectedEnemy) return;

    const TpX = event.clientX;
    const TpY = event.clientY;

    const eW = selectedEnemy.offsetWidth;
    const eH = selectedEnemy.offsetHeight;

    selectedEnemy.style.left = (TpX - eW/2) + "px";
    selectedEnemy.style.top  = (TpY - eH/2) + "px";
});

function setCanvas() {
    canvas = document.getElementById("mycanvas");
    ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}

function addCross() {
    const x = Math.random() * (canvas.width - 32);
    const y = Math.random() * (canvas.height - 32);

    crosses.push({
        x,
        y,
        created: Date.now()
    });
}

function draw() {
    const square = document.getElementById("square");
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    const now = Date.now();

    // Turn crosses into enemies
    for (let i = crosses.length - 1; i >= 0; i--) {
        const cross = crosses[i];
        if (now - cross.created > lifetime) {

            const div = document.createElement("div");
            div.className = "enemy";
            div.style.left = cross.x + "px";
            div.style.top = cross.y + "px";
            document.body.appendChild(div);

            const enemy = {
                x: cross.x,
                y: cross.y,
                w: 40,
                h: 40,
                element: div
            };

            enemies.push(enemy);

            div.addEventListener("click", () => {

    const eX = parseInt(div.style.left);
    const eY = parseInt(div.style.top);

    const sqW = square.offsetWidth;
    const sqH = square.offsetHeight;

    const eW = div.offsetWidth;
    const eH = div.offsetHeight;

    // center square on enemy
    const newX = eX - (sqW - eW) / 2;
    const newY = eY - (sqH - eH) / 2;

    square.style.left = newX + "px";
    square.style.top = newY + "px";

    div.style.backgroundColor = "green";
});
      div.addEventListener("click", (event) => {
    event.stopPropagation();     
    selectedEnemy = div;          
});



            crosses.splice(i, 1);
        }
    }

    ctx.strokeStyle = "red";
    ctx.lineWidth = 4;
    crosses.forEach(cross => {
        ctx.beginPath();
        ctx.moveTo(cross.x, cross.y);
        ctx.lineTo(cross.x + 32, cross.y + 32);
        ctx.moveTo(cross.x + 32, cross.y);
        ctx.lineTo(cross.x, cross.y + 32);
        ctx.stroke();
    });

    requestAnimationFrame(draw);
}

setCanvas();
setInterval(addCross, 1000);
draw();
</script>
</body>
</html>
